:root {
  color-scheme: light dark;
  /* Theme colors */
  --color-bg: #ffffff;
  --color-surface: #f7f8fa;
  --color-text: #111827;
  --color-muted: #6b7280;
  --color-border: #e5e7eb;
  --color-primary: #2563eb; /* blue-600 */
  --color-primary-strong: #1d4ed8; /* blue-700 */
  --color-primary-soft: #eff6ff; /* blue-50 */
  --color-danger: #dc2626;
  --color-success: #16a34a;
  --color-warning: #d97706;
  --color-inverse: #ffffff;

  /* Borders */
  --border-thickness: 2px;

  /* Radii */
  --radius-sm: 6px;
  --radius-md: 8px;
  --radius-lg: 12px;

  /* Spacing scale */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 24px;
  --space-6: 32px;

  /* Shadows */
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
  --shadow-md: 0 6px 16px rgba(0,0,0,0.08);

  /* Typography */
  --fs-sm: .875rem;
  --fs-base: 1rem;
  --fs-lg: 1.125rem;
  --fs-xl: 1.25rem;

  /* Editor selection (customizable) */
  --editor-selection-bg: rgba(37, 99, 235, 0.25);
  --editor-selection-text: inherit;

  /* Code/mono typography */
  --font-mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --code-font-size: .95rem;
  --code-line-height: 1.5;

  /* Input spacing */
  --input-padding-y: 6px;
  --input-padding-x: 8px;

  /* Scrollbars */
  --scrollbar-size: 8px;
  --scrollbar-thumb: rgba(100, 116, 139, 0.6); /* slate-500 */
  --scrollbar-thumb-hover: rgba(100, 116, 139, 0.9);
  --scrollbar-track: transparent;

  /* Syntax token colors (Python) */
  --py-kw: #a855f7; /* violet-500 */
  --py-str: #16a34a; /* green-600 */
  --py-comm: #6b7280; /* gray-500 */
  --py-num: #f59e0b; /* amber-500 */
  --py-builtin: #0ea5e9; /* sky-500 */

  /* Official brand colors reused for background and title gradient */
  --brand-1: #2563eb; /* blue-600 */
  --brand-2: #10b981; /* emerald-500 */

  /* Variables controlling behaviour of tilt (3d) cards */
  --tiltcard-max-rot: 18deg;
  --tiltcard-ease-speed: 0.12;
}

@media (prefers-color-scheme: dark) {
  :root {
    --color-bg: #0f172a; /* slate-900 */
    --color-surface: #111827; /* gray-900 */
    --color-text: #e5e7eb; /* gray-200 */
    --color-muted: #9ca3af; /* gray-400 */
    --color-border: #374151; /* gray-700 */
    --color-primary: #60a5fa; /* blue-400 */
    --color-primary-strong: #3b82f6; /* blue-500 */
    --color-primary-soft: rgba(96,165,250,0.15);
    --color-inverse: #0b1020;

    /* Scrollbars */
    --scrollbar-thumb: rgba(148, 163, 184, 0.5); /* slate-400 */
    --scrollbar-thumb-hover: rgba(148, 163, 184, 0.8);
    --scrollbar-track: transparent;

    /* Syntax token colors (Python) */
    --py-kw: #c084fc; /* violet-400 */
    --py-str: #4ade80; /* green-400 */
    --py-comm: #9ca3af; /* gray-400 */
    --py-num: #fbbf24; /* amber-400 */
    --py-builtin: #38bdf8; /* sky-400 */
  }
}

* { box-sizing: border-box; }

html, body, #root { height: 100%; }

body {
  margin: 0;
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  line-height: 1.6;
  /* Background: non-repeating, stronger gradients without visible seams */
  background-color: var(--color-bg);
  background-image:
    radial-gradient(1500px 820px at 110% -10%, color-mix(in srgb, var(--brand-1) 26%, transparent), transparent 70%),
    radial-gradient(1200px 720px at -10% 0%, color-mix(in srgb, var(--brand-2) 20%, transparent), transparent 75%);
  background-repeat: no-repeat, no-repeat;
  background-attachment: fixed, fixed;
  color: var(--color-text);
  padding: var(--space-5);
}

/* Global text selection: disable site-wide by default */
body, body * {
  -webkit-user-select: none;
  -ms-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

/* Allow selection on Account page */
.account-page, .account-page * {
  -webkit-user-select: text;
  -ms-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

/* Allow selection in code editor textarea */
.code-editor {
  -webkit-user-select: text;
  -ms-user-select: text;
  -moz-user-select: text;
  user-select: text;
}

img, svg, video { max-width: 100%; height: auto; }

a { color: var(--color-primary); text-decoration: none; }
a:hover { text-decoration: underline; }

/* Layout */
.container {
  max-width: 1200px;
  margin: 0 auto;
}

.layout { display: grid; grid-template-columns: 240px 1fr; gap: var(--space-4); }

.sidebar {
  border-right: var(--border-thickness) solid var(--color-border);
  padding-right: var(--space-3);
}

.content { padding: var(--space-4); }

.header-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  flex-wrap: wrap;
  padding: var(--space-1) var(--space-4);
}

/* Navigation list */
.nav-list { list-style: none; margin: 0; padding: 0; }
.nav-item + .nav-item { margin-top: 6px; }
.nav-button {
  width: 100%;
  text-align: left;
  padding: 12px 14px;
  border-radius: var(--radius-md);
  border: var(--border-thickness) solid var(--color-border);
  background: var(--color-surface);
  color: inherit;
  cursor: pointer;
  box-shadow: var(--shadow-sm);
  transition: transform 160ms ease-out, box-shadow 160ms ease-out, background-color 160ms ease-out, border-color 160ms ease-out;
}
.nav-button:hover { background: var(--color-primary-soft); border-color: var(--color-primary); box-shadow: var(--shadow-md); transform: translateY(-1px); }
.nav-button strong { font-weight: 600; }
.nav-button.is-active { background: var(--color-primary-soft); border-color: var(--color-primary); }
.nav-button.is-active strong { font-weight: 700; }

/* Components */
.input {
  padding: var(--input-padding-y) var(--input-padding-x);
  border: var(--border-thickness) solid var(--color-border);
  border-radius: var(--radius-sm);
  background: var(--color-bg);
  color: var(--color-text);
}

.btn {
  padding: 10px 14px;
  border-radius: var(--radius-sm);
  border: var(--border-thickness) solid var(--color-border);
  cursor: pointer;
  background: var(--color-surface);
  color: inherit;
  box-shadow: var(--shadow-sm);
  transition: background-color 180ms ease-out, border-color 180ms ease-out, color 180ms ease-out, transform 180ms ease-out, box-shadow 180ms ease-out;
}
.btn:disabled { opacity: .6; cursor: default; }
.btn-primary { background: var(--color-primary); color: var(--color-inverse); border-color: var(--color-primary-strong); }
.btn-primary:hover { background: var(--color-primary-strong); }
.btn-secondary { background: var(--color-surface); }
.btn-ghost { background: transparent; }

.lesson {
  padding: var(--space-4);
  border: var(--border-thickness) solid var(--color-border);
  border-radius: var(--radius-md);
  background: var(--color-surface);
  box-shadow: var(--shadow-sm);
}

/* Text helpers */
.text-muted { color: var(--color-muted); }
.text-danger { color: var(--color-danger); }
.text-success { color: var(--color-success); }

.error { color: var(--color-danger); font-weight: 600; }

/* Utilities */
.mr-2 { margin-right: var(--space-2); }
.mt-1 { margin-top: var(--space-1); }
.mt-2 { margin-top: var(--space-2); }
.mt-3 { margin-top: var(--space-3); }
.mt-4 { margin-top: var(--space-4); }
.mb-2 { margin-bottom: var(--space-2); }
.ml-auto { margin-left: auto; }

.cluster { display: flex; gap: var(--space-2); align-items: center; flex-wrap: wrap; }

footer { color: var(--color-muted); }

/* Focus styles */
.btn:focus-visible, .input:focus-visible, .nav-button:focus-visible { outline: 2px solid var(--color-primary); outline-offset: 2px; }

/* Modal */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.4);
  display: grid;
  place-items: center;
  z-index: 1000;
}
.modal {
  width: min(92vw, 520px);
  background: var(--color-surface);
  color: var(--color-text);
  border: var(--border-thickness) solid var(--color-border);
  border-radius: var(--radius-md);
  box-shadow: var(--shadow-md);
}
.modal-header { padding: var(--space-4); border-bottom: var(--border-thickness) solid var(--color-border); }
.modal-body { padding: var(--space-4); }
.modal-actions { padding: var(--space-3) var(--space-4) var(--space-4); display: flex; gap: var(--space-2); justify-content: flex-end; }


/* Code Interpreter styles */
.interpreter {
  border: var(--border-thickness) solid var(--color-border);
  border-radius: var(--radius-md);
  background: var(--color-surface);
  box-shadow: var(--shadow-sm);
}
.interpreter-header, .console-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-1) var(--space-2);
}
.interpreter-header {
  border-bottom: var(--border-thickness) solid var(--color-border);
}
/* .interpreter-body removed: textarea rendered directly for a flatter structure */
.interpreter-footer { padding: var(--space-2); border-top: var(--border-thickness) solid var(--color-border); }
.interpreter-footer-row { display: grid; grid-template-columns: 1fr minmax(240px, 320px); gap: var(--space-3); align-items: stretch; }
.interpreter-side-panel { border: var(--border-thickness) solid var(--color-border); border-radius: var(--radius-sm); background: var(--color-bg); padding: var(--space-2); }
@media (max-width: 700px) { .interpreter-footer-row { grid-template-columns: 1fr; } }

/* Editor with line numbers */
.code-editor-wrapper {
  display: grid;
  grid-template-columns: auto 1fr;
  align-items: stretch;
}
.code-gutter {
  user-select: none;
  color: var(--color-muted);
  background: transparent;
  width: 4ch; /* enough for 3-4 digit line numbers */
  height: 220px; /* match editor height for scroll sync */
  padding: 6px var(--space-2); /* match editor vertical padding */
  text-align: right;
  overflow: hidden; /* scroll synced from editor without showing a scrollbar */
  scroll-behavior: auto;
}
.code-gutter-pre,
.code-highlight-pre,
.code-readonly-pre {
  margin: 0;
  white-space: pre;
  line-height: var(--code-line-height);
  font-family: var(--font-mono);
  font-size: var(--code-font-size);
}

.code-editor {
  width: 100%;
  height: 220px;
  resize: none; /* interpreter shouldn't be resizable */
  font-family: var(--font-mono);
  font-size: var(--code-font-size);
  line-height: var(--code-line-height);
  border-radius: 0; /* remove rounded corners to make editor unobtrusive */
  border: none; /* make seamless */
  outline: none;
  background: transparent;
  /* Hide native textarea text to avoid double-render (overlay shows highlighted text) */
  color: transparent;
  caret-color: transparent; /* hide native caret; we'll draw a custom one */
  tab-size: 4;
  scroll-behavior: auto;
  position: relative;
  z-index: 2;
}

.console {
  border: var(--border-thickness) solid var(--color-border);
  border-radius: var(--radius-sm);
  background: var(--color-bg);
}
.console-header {
  border-bottom: none;
  flex-wrap: nowrap; /* prevent line break */
  white-space: nowrap; /* ensure single line header */
}
.console-body {
  padding: var(--space-1) var(--space-2);
  height: 80px; /* fixed size: half of previous */
  overflow: auto; /* scrollable content */
}
.console-pre {
  white-space: pre-wrap; /* support new lines */
  margin: 0;
}



/* Code editor overlay for syntax highlighting */
.code-editor-cell { position: relative; height: 220px; overflow: hidden; contain: paint; }
.code-highlight {
  position: absolute;
  inset: 0;
  padding: var(--input-padding-y) var(--input-padding-x); /* match .input padding */
  pointer-events: none;
  overflow: hidden; /* hide overlay scrollbars; we scroll via translate */
  tab-size: 4;
  z-index: 1;
  will-change: transform;
  contain: paint;
}
.code-highlight-pre {
  will-change: transform;
  backface-visibility: hidden;
  transition: none;
}

/* Token colors */
.tok-kw { color: var(--py-kw); }
.tok-str { color: var(--py-str); }
.tok-comm { color: var(--py-comm); font-style: italic; }
.tok-num { color: var(--py-num); }
.tok-builtin { color: var(--py-builtin); }

/* Editor focus outline off specifically for code editor */
.code-editor:focus-visible { outline: none; }

/* Allow selection drag across editor container so users can select to end-of-line even when cursor leaves the textarea */
.code-editor-wrapper,
.code-editor-cell {
  -webkit-user-select: text;
  -ms-user-select: text;
  -moz-user-select: text;
  user-select: text;
}


/* Editor selection styling for code editor */
.code-editor::selection { background: var(--editor-selection-bg); color: var(--editor-selection-text); }
.code-editor::-moz-selection { background: var(--editor-selection-bg); color: var(--editor-selection-text); }

/* Custom caret overlay */
.code-caret {
  position: absolute;
  width: 2px;
  background: var(--color-text);
  border-radius: 1px;
  pointer-events: none;
  opacity: 1;
  /* No blink; caret always visible. Transition is controlled inline and uses ease-out when enabled */
  transition: none;
  z-index: 3;
  transform-origin: top left;
  animation: caretPulse 1s ease-out infinite;
  will-change: top, left, height;
}
@keyframes caretBlink {
  0%, 49% { opacity: 1; }
  50%, 100% { opacity: 0; }
}
@keyframes caretPulse {
  0%, 100% { transform: scaleY(1) translateY(0%); }
  50% { transform: scaleY(0.75) translateY(15%); }
}
@media (prefers-reduced-motion: reduce) {
  .code-caret { transition: none; animation: none; }
}

/* Sleek global scrollbars */
/* Firefox */
html { scrollbar-color: var(--scrollbar-thumb) var(--scrollbar-track); scrollbar-width: thin; }
/* WebKit/Blink */
*::-webkit-scrollbar { width: var(--scrollbar-size); height: var(--scrollbar-size); }
*::-webkit-scrollbar-thumb {
  background-color: var(--scrollbar-thumb);
  border-radius: 999px;
  border: var(--border-thickness) solid transparent; /* creates a pill look */
  background-clip: content-box;
}
*::-webkit-scrollbar-thumb:hover { background-color: var(--scrollbar-thumb-hover); }
*::-webkit-scrollbar-track { background: var(--scrollbar-track); }


/* MCQ choice buttons */
.choice-list { display: grid; gap: var(--space-2); }
.choice-button { display: block; width: 100%; text-align: left; }
.choice-button.is-correct { border-color: var(--color-success); }
.choice-button.is-incorrect { border-color: var(--color-danger); }


/* Fade-in animation for lesson elements */
@keyframes fade-in {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}
.fade-in { animation: fade-in 220ms ease-out both; }




/* Spinner (vanilla CSS) */
.loading { display: flex; align-items: center; gap: var(--space-2); padding: var(--space-2); color: var(--color-muted); }
.spinner { width: 18px; height: 18px; border: 3px solid var(--color-border); border-top-color: var(--color-primary); border-radius: 50%; animation: spin 800ms ease-out infinite; }
@keyframes spin { to { transform: rotate(360deg); } }


/* Read-only code regions (prefix/suffix) */
.code-readonly {
  margin: 0;
  padding: var(--space-2);
  border: none;
  background: rgba(0,0,0,0.2);
  overflow: auto;
}
.code-readonly, .code-readonly * {
  -webkit-user-select: text;
  -ms-user-select: text;
  -moz-user-select: text;
  user-select: text;
}


/* Language selection menu */
.language-menu {
  position: absolute;
  top: 0;
  left: 0;
  height: 100vh;
  width: 100vw;
  display: grid;
  place-items: center;
}
.language-grid {
  display: grid;
  grid-template-columns: repeat(3, minmax(180px, 240px));
  gap: var(--space-4);
}
@media (max-width: 700px) {
  .language-grid { grid-template-columns: 1fr; }
}
.language-grid .btn {
  padding: 16px 24px;
  font-size: var(--fs-lg);
}

/* Language cards */
.lang-card {
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  gap: var(--space-2);
  background: var(--color-surface);
  border-color: var(--color-border);
}
.lang-card:hover {
  background: var(--color-primary-soft);
  border-color: var(--color-primary);
}
.lang-icon { width: 100%; height: 100%; object-fit: contain; }
.lang-title { font-weight: 700; font-size: var(--fs-xl); }
.lang-subtitle { font-size: var(--fs-sm); color: var(--color-muted); line-height: 1.4; }
.lang-difficulty { font-weight: 600; margin-top: 2px; }
.lang-difficulty.diff-baby { color: var(--color-primary); }
.lang-difficulty.diff-easy { color: var(--color-success); }
.lang-difficulty.diff-moderate { color: var(--color-warning); }

/* Header visibility: appears at top or when scrolling up */
.site-header {
  position: static;
  background: var(--color-bg);
  border-bottom: var(--border-thickness) solid var(--color-border);
  margin-bottom: var(--space-4);
  transition: transform 200ms ease-out, opacity 200ms ease-out;
}

.site-header.is-floating {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 50;
}

.site-header.is-hidden {
  transform: translateY(-100%);
  opacity: 0;
  pointer-events: none;
}

/* Headings */
h1, h2, h3 { letter-spacing: -0.01em; }
h1 { font-size: 1.9rem; }

/* Generic button interactions */
.btn:hover { transform: translateY(-1px); box-shadow: var(--shadow-md); }
.btn:active { transform: translateY(0); box-shadow: var(--shadow-sm); }

/* Disable animations when interaction is disallowed (disabled or aria-disabled) */
.btn:disabled,
.btn[aria-disabled="true"],
.nav-button:disabled,
.nav-button[aria-disabled="true"],
.choice-button:disabled,
.choice-button[aria-disabled="true"] {
  transition: none !important;
  transform: none !important;
  box-shadow: var(--shadow-sm) !important;
}

.btn:disabled:hover,
.btn[aria-disabled="true"]:hover,
.nav-button:disabled:hover,
.nav-button[aria-disabled="true"]:hover,
.choice-button:disabled:hover,
.choice-button[aria-disabled="true"]:hover {
  transform: none !important;
  box-shadow: var(--shadow-sm) !important;
  background: var(--color-surface) !important;
  border-color: var(--color-border) !important;
}

/* Lesson card polish */
.lesson { border-color: color-mix(in srgb, var(--color-border) 85%, transparent); }
@supports not (color-mix: in srgb, white 50%, black 50%) {
  /* Fallback: keep default border */
}

/* MCQ button states */
.choice-button.is-correct { background: rgba(16, 185, 129, 0.08); }
.choice-button.is-incorrect { background: rgba(220, 38, 38, 0.08); }

/* Brand title: uppercase with static base gradient and animated sheen */
.brand-button { background: none; border: none; padding: 0; margin: 0; font: inherit; color: inherit; cursor: pointer; }
.brand-title {
  text-transform: uppercase;
  font-size: clamp(2.2rem, 5vw, 3rem);
  line-height: 1.1;
  font-weight: 900; /* bolder title */
  margin-block: var(--space-3); /* bigger margins around title */
  margin-inline: 0;
  /* Two-layer background: base brand gradient + diagonal sheen sweep */
  background-image:
    linear-gradient(90deg, var(--brand-1), var(--brand-2)),
    linear-gradient(115deg, rgba(255,255,255,0) 42%, rgba(255,255,255,0.65) 50%, rgba(255,255,255,0) 58%);
  background-size: 100% 100%, 240% 240%;
  background-position: 0% 0%, -180% 50%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  color: transparent;
  animation: brand-sheen 6s ease-out infinite;
}
@keyframes brand-sheen {
  0%, 70% { background-position: 0% 0%, -180% 50%; }
  75% { background-position: 0% 0%, 180% 50%; }
  100% { background-position: 0% 0%, 180% 50%; }
}
@media (prefers-reduced-motion: reduce) {
  .brand-title {
    animation: none;
    background-image: linear-gradient(90deg, var(--brand-1), var(--brand-2));
    background-size: 100% 100%;
    background-position: 0% 0%;
  }
}

/* Preserve MCQ correctness highlighting even on hover/disabled */
.choice-button.is-correct,
.choice-button.is-correct:hover,
.choice-button.is-correct:disabled,
.choice-button.is-correct[aria-disabled="true"],
.choice-button.is-correct:disabled:hover,
.choice-button.is-correct[aria-disabled="true"]:hover {
  border-color: var(--color-success) !important;
  background: rgba(16, 185, 129, 0.08) !important;
}
.choice-button.is-incorrect,
.choice-button.is-incorrect:hover,
.choice-button.is-incorrect:disabled,
.choice-button.is-incorrect[aria-disabled="true"],
.choice-button.is-incorrect:disabled:hover,
.choice-button.is-incorrect[aria-disabled="true"]:hover {
  border-color: var(--color-danger) !important;
  background: rgba(220, 38, 38, 0.08) !important;
}

/* Locked lesson buttons (nav-button) should look disabled (muted) and remain non-interactive */
.nav-button:disabled,
.nav-button[aria-disabled="true"] {
  opacity: .6;
  cursor: default;
  background: var(--color-surface);
  border-color: var(--color-border);
}
.nav-button:disabled:hover,
.nav-button[aria-disabled="true"]:hover {
  background: var(--color-surface) !important;
  border-color: var(--color-border) !important;
}

code {
  background: rgba(0,0,0,0.3);
  padding: 0.2em 0.4em;
  font-family: var(--font-mono), monospace;
}

.card-3d{
  --w:320px;
  --h:420px;
  perspective:1200px;
  width:var(--w);
  height:var(--h);
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
}
.card-3d .card-inner{
  width:100%;
  height:100%;
  border-radius:18px;
  background:linear-gradient(135deg,rgba(255,255,255,0.05),rgba(255,255,255,0.02));
  border:1px solid rgba(255,255,255,0.06);
  box-shadow:0 18px 40px rgba(2,6,23,0.6);
  transform-style:preserve-3d;
  will-change:transform;
  overflow:hidden;
  position:relative;
  transition:box-shadow 0.3s ease;
  display:grid;
  place-items:center;
  color:#e6eef8;
  text-align:center;
  padding:24px;
}
.card-3d .card-inner h1{margin:0 0 8px;font-size:20px;}
.card-3d .card-inner p{margin:0;font-size:13px;opacity:0.85;}
.card-3d .glare{
  position:absolute;
  top:0;left:0;
  width:200%;height:200%;
  transform:translate(-50%,-50%) rotate(45deg);
  pointer-events:none;
  background:radial-gradient(600px 200px at 10% 20%,rgba(255,255,255,0.18),rgba(255,255,255,0.02) 25%,transparent 40%);
  mix-blend-mode:overlay;
  opacity:0.6;
  filter:blur(20px);
  transition:opacity 200ms linear;
}
@media(max-width:420px){
  .card-3d{--w:280px;--h:360px;}
}
